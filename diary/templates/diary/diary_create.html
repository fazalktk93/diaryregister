{% extends "base.html" %}
{% block title %}New Diary{% endblock %}

{% block content %}
<div class="page-header mb-4">
  <div>
    <h1 class="mb-1"><i class="bi bi-plus-circle"></i> Create New Diary</h1>
    <p class="text-light mb-0 opacity-75">Enter diary details to get started</p>
  </div>
</div>

<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-body">
        <form method="post" novalidate>
          {% csrf_token %}

          {% for field in form %}
            <div class="mb-3">
              <label for="{{ field.id_for_label }}" class="form-label">
                {{ field.label }}
                {% if field.field.required %}<span class="text-danger" aria-label="required">*</span>{% endif %}
              </label>
              {{ field }}
              {% if field.errors %}
                <div class="alert alert-danger mt-1 py-1 px-2 small mb-0">
                  <i class="bi bi-exclamation-circle"></i> {{ field.errors|striptags }}
                </div>
              {% endif %}
            </div>
          {% endfor %}

          <div class="d-flex gap-2 mt-4">
            <button class="btn btn-primary" type="submit">
              <i class="bi bi-plus-circle"></i> Create Diary
            </button>
            <a class="btn btn-outline-secondary" href="{% url 'diary_list' %}">
              <i class="bi bi-x-circle"></i> Cancel
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Enable "No. of folders" only when File is selected
  document.addEventListener("DOMContentLoaded", function () {
    const kind = document.getElementById("id_file_letter");
    const folders = document.getElementById("id_no_of_folders");
    if (!kind || !folders) return;

    function syncFoldersState() {
      const v = (kind.value || "").toLowerCase();
      const enabled = v === "file" || v === "service book";
      folders.disabled = !enabled;
      folders.closest('.mb-3')?.classList.toggle('opacity-50', !enabled);
      if (!enabled) folders.value = 0;
    }

    kind.addEventListener("change", syncFoldersState);
    syncFoldersState();
  });
</script>
{% endblock %}
